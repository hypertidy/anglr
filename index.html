<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mesh Topology and Visualization for Spatial Data • anglr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Mesh Topology and Visualization for Spatial Data">
<meta property="og:description" content="Gives direct access to generic 3D tools and provides a full suite 
 of mesh-creation and 3D plotting functions. By extending the rgl package 
 conversion and visualization functions for the mesh3d class a wide variety of
 complex spatial data can be brought into 3D scenes. These tools allow for 
 spatial raster, polygons, and lines that are common in GIS contexts to be 
 converted into mesh forms with high flexibility and the ability to integrate 
 disparate data types. Vector and raster data can be seamlessly combined as 
 meshes, and surfaces can be set to have material properties based on data 
 values or with image textures. Textures and other data combinations use 
 projection transformations to map between coordinate systems, and objects can 
 be easily visualized in an interactive scene at any stage. This package relies 
 on the RTriangle package for high-quality triangular meshing which is 
 licensed restrictively under CC BY-NC-SA 4.0. ">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">anglr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.8.0.9002</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="articles/anglr.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/hypertidy/anglr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<!-- README.md is generated from README.Rmd. Please edit that file -->
<div class="section level1">
<div class="page-header"><h1 id="anglr">anglr<a class="anchor" aria-label="anchor" href="#anglr"></a>
</h1></div>
<p><a href="https://gist.github.com/mdsumner/81be7955ab19c052cea753230d91a20c" class="external-link"><img align="right" src="https://gist.githubusercontent.com/mdsumner/81be7955ab19c052cea753230d91a20c/raw/f6a2fdb773bcf73db97879d25de8c09a210b7a8e/anglr2.gif"></a></p>
<p>The anglr package aims to provide direct access to generic 3D tools.</p>
<p>… geospatial is cool … 3D is cool … putting them together is <em>challenging</em> …</p>
<p>The anglr package provides a full suite of mesh-creation and 3D plotting functions, extending the <a href="https://CRAN.r-project.org/package=rgl" class="external-link">rgl package</a> functions <code><a href="reference/as.mesh3d.html">as.mesh3d()</a></code>, <code><a href="reference/plot3d.html">plot3d()</a></code>, <code><a href="reference/persp3d.html">persp3d()</a></code>, <code><a href="reference/wire3d.html">wire3d()</a></code>, and <code><a href="reference/dot3d.html">dot3d()</a></code>.</p>
<p>Key working examples are in <a href="https://hypertidy.github.io/anglr/reference/as.mesh3d.html" class="external-link">?anglr::as.mesh3d</a> and <a href="https://hypertidy.github.io/anglr/reference/plot3d.html" class="external-link">?anglr::plot3d</a>.</p>
<div class="section level2">
<h2 id="features">Features<a class="anchor" aria-label="anchor" href="#features"></a>
</h2>
<ul>
<li><p>Convert geospatial objects to 3D with <code><a href="reference/as.mesh3d.html">as.mesh3d()</a></code> - works for matrix, raster, sf-polygons, sp-polygons, silicate-triangles</p></li>
<li><p>Plot geospatial objects with <code><a href="reference/plot3d.html">plot3d()</a></code> - works for matrix, raster, sf (any type), sp, trip, silicate</p></li>
<li><p>Merge raster and vector with <code>as.mesh3d</code> - elevate polygons or lines with a raster dem</p></li>
<li><p>Drape imagery onto raster or polygon surfaces with <code>as.mesh3d</code> - <code>image_texture</code> argument</p></li>
<li><p>Copy Z values from a raster, polygon/line field value, or constant onto mesh vertices</p></li>
<li><p>Create any mesh above and reproject to any projection, including geocentric</p></li>
<li><p>Use <code><a href="reference/shade3d.html">shade3d()</a></code> or <code><a href="reference/plot3d.html">plot3d()</a></code> or <code><a href="reference/wire3d.html">wire3d()</a></code> from the rgl package to plot any <code>mesh3d</code> object created. (<code><a href="reference/plot3d.html">plot3d()</a></code> also calls the converters for non-mesh types, so we can quickly get a 3D scene from any spatial data)</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="why-anglr-isnt-this-all-done">Why anglr, isn’t this all done?<a class="anchor" aria-label="anchor" href="#why-anglr-isnt-this-all-done"></a>
</h2>
<p>The rgl package has long supported powerful interactive 3D visualizations for points, lines, and surfaces. Surfaces can be of any form, triangles or quad primitives wrapped around a bunny, a globe, or platonic shapes such as cubes and octahedrons. There is support for <em>textures</em>, which is essentially imagery draped onto a surface at native resolution - there is no loss of image quality at all.</p>
<p>But, rgl is hard to use, and there are very few helpers for converting existing formats into the right form. There are some, for example <code><a href="reference/as.mesh3d.html">as.mesh3d()</a></code> methods for commonly used triangulation packages. It also was harder to use in the past, but recently has been improved a great deal for taking generic data and converting it.</p>
<p>There has been little support in rgl for <em>geo-spatial</em> data structures, such as spatial rasters, polygons and lines that are common in GIS workflows. The anglr package aims to fill this gap, and gives total control over conversion of spatial and other data into mesh forms - even if visualization is not the end goal.</p>
<p>There <em>are</em> packages that convert matrices and imagery to compelling animated 3D scenes, but these are targetted at presentation rather than generality and development. The scenes are targetted towards presentation, and adding general extra data to a given scene requires a lot of workarounds. There are also only few well-known packages that use the rgl mesh3d format (Rvcg, …). Many examples use <code><a href="https://dmurdoch.github.io/rgl/dev/reference/surface3d.html" class="external-link">rgl::surface3d()</a></code> which is limited to the model that provides for an input matrix and overlaid colours or textures. These cannot be wrapped arbitrarily around curves in any 3D coordinate system.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>Install from <a href="https://CRAN.r-project.org/package=anglr" class="external-link">CRAN</a> with</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"anglr"</span><span class="op">)</span></span></code></pre></div>
<p>To install the development version use</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## install.packages("remotes")  ## if required</span></span>
<span><span class="fu">remotes</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"hypertidy/anglr"</span><span class="op">)</span></span></code></pre></div>
<p>Feel free to contact me via the <a href="https://github.com/hypertidy/anglr/issues/" class="external-link">Issues</a> if you have problems, or these notes don’t make sense.</p>
<div class="section level3">
<h3 id="ubuntudebian">Ubuntu/Debian<a class="anchor" aria-label="anchor" href="#ubuntudebian"></a>
</h3>
<p>On Linux you will need at least the following installed.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>libproj<span class="sc">-</span>dev \</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a> libgl1<span class="sc">-</span>mesa<span class="sc">-</span>dev \</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a> libglu1<span class="sc">-</span>mesa<span class="sc">-</span>dev</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="get-involved">Get involved!<a class="anchor" aria-label="anchor" href="#get-involved"></a>
</h2>
<p>Let me know if you have problems, or are interested in this work. See the issues tab to make suggestions or report bugs.</p>
<p><a href="https://github.com/hypertidy/anglr/issues" class="external-link uri">https://github.com/hypertidy/anglr/issues</a></p>
</div>
<div class="section level2">
<h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a>
</h2>
<p>These examples are a bit out of date, anglr visualization works best interactively and with your own data, but these demo pages give a flavour for what is possible.</p>
<div class="section level3">
<h3 id="demo-01---merge-vector-and-raster-data">Demo 01 - merge vector and raster data<a class="anchor" aria-label="anchor" href="#demo-01---merge-vector-and-raster-data"></a>
</h3>
<p>An <a href="https://hypertidy.github.io/anglr-demos/demo01.html" class="external-link">example of merging vector and raster</a>, with a continuous interpretation applied to the polygon mesh and underlying elevation.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## a global DEM</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"gebco"</span>, package <span class="op">=</span> <span class="st">"anglr"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="co">## North Carolina, the sf boilerplate polygon layer</span></span>
<span><span class="va">nc</span> <span class="op">&lt;-</span> <span class="fu">read_sf</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"shape/nc.shp"</span>, package<span class="op">=</span><span class="st">"sf"</span>, mustWork <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hypertidy/anglr" class="external-link">anglr</a></span><span class="op">)</span> </span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/hypertidy/silicate" class="external-link">silicate</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">p_mesh</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/DEL.html">DEL</a></span><span class="op">(</span><span class="va">nc</span>, max_area <span class="op">=</span> <span class="fl">0.002</span><span class="op">)</span></span>
<span><span class="co">## a relief map, composed of triangles grouped by polygon with ##  interpolated raster elevation </span></span>
<span><span class="va">p_mesh</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/copy_down.html">copy_down</a></span><span class="op">(</span><span class="va">p_mesh</span>, z <span class="op">=</span> <span class="va">gebco</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">## plot the scene</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/dmurdoch/rgl" class="external-link">rgl</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/rgl.fns.html" class="external-link">rgl.clear</a></span><span class="op">(</span><span class="op">)</span>  <span class="co">## rerun the cycle from clear to widget in browser contexts </span></span>
<span><span class="fu"><a href="reference/plot3d.html">plot3d</a></span><span class="op">(</span><span class="va">p_mesh</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/bg.html" class="external-link">bg3d</a></span><span class="op">(</span><span class="st">"black"</span><span class="op">)</span>; <span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/material.html" class="external-link">material3d</a></span><span class="op">(</span>specular <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/aspect3d.html" class="external-link">aspect3d</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">.1</span><span class="op">)</span></span></code></pre></div>
<p>Follow this link to see the result:</p>
<p><a href="https://hypertidy.github.io/anglr-demos/demo01.html" class="external-link">Demo01</a></p>
<p>Here the <code>z</code> argument to <code><a href="reference/copy_down.html">copy_down()</a></code> is a raster, and so the <code>z_</code> coordinate of the mesh is updated by extracting values from the raster using bilinear interpolation.</p>
</div>
<div class="section level3">
<h3 id="demo-02---copy-discrete-values-to-polygon-elevation">Demo 02 - copy discrete values to polygon elevation<a class="anchor" aria-label="anchor" href="#demo-02---copy-discrete-values-to-polygon-elevation"></a>
</h3>
<p>An <a href="https://hypertidy.github.io/anglr-demos/demo02.html" class="external-link">example of elevating polygons with constant attribute values</a>, a discrete interpretation that requires separating the (until-now) continuous mesh of polygon features.</p>
<p>With argument <code>z</code> set to a column in the layer or a specific vector of values this is used as a constant offset for the <code>z_</code> value, and the mesh is <em>separated by feature</em>.</p>
<p>(The simpler TRI model is used here because we only need poor quality triangles for planar geometry. )</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">## either form works</span></span>
<span><span class="co">#c_mesh &lt;- copy_down(TRI(nc), z = p_mesh$object$BIR74)</span></span>
<span><span class="va">c_mesh</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/copy_down.html">copy_down</a></span><span class="op">(</span><span class="fu"><a href="reference/TRI.QUAD.html">TRI</a></span><span class="op">(</span><span class="va">nc</span><span class="op">)</span>, z <span class="op">=</span> <span class="st">"BIR74"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/open3d.html" class="external-link">open3d</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/plot3d.html">plot3d</a></span><span class="op">(</span><span class="va">c_mesh</span><span class="op">)</span> </span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/bg.html" class="external-link">bg3d</a></span><span class="op">(</span><span class="st">"black"</span><span class="op">)</span>; <span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/material.html" class="external-link">material3d</a></span><span class="op">(</span>specular <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://dmurdoch.github.io/rgl/dev/reference/aspect3d.html" class="external-link">aspect3d</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">.2</span><span class="op">)</span></span></code></pre></div>
<p>Follow this link to see the result:</p>
<p><a href="https://hypertidy.github.io/anglr-demos/demo02.html" class="external-link">Demo02</a></p>
<p>In the silicate models, complex objects are decomposed to a set of related, linked tables. Object identity is maintained with attribute metadata and this is carried through to colour and other aesthetics.</p>
<p>Plot (3D) methods take those tables and generate the “indexed array” structures needed for ‘rgl’. (<code>plot3d</code> will return the rgl-model form). This gets us part of the way towards having the best of both worlds of GIS and 3D graphics.</p>
<p>Another example shows this approach applied to a 3D multipatch shapefile, with a few easy steps we can plot a wiremesh or roof/floor polygons from a civic building footprint.</p>
<p><a href="http://rpubs.com/cyclemumner/367010" class="external-link uri">http://rpubs.com/cyclemumner/367010</a></p>
<hr>
<p>Please note that this project is released with a <a href="https://github.com/hypertidy/anglr/blob/master/CONDUCT.md" class="external-link">Contributor Code of Conduct</a>. By participating in this project you agree to abide by its terms.</p>
</div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=anglr" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/hypertidy/anglr/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/hypertidy/anglr/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://creativecommons.org/licenses/by-nc-sa/4.0" class="external-link">CC BY-NC-SA 4.0</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing anglr</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Michael D. Sumner <br><small class="roles"> Author, maintainer </small>  </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/hypertidy/anglr/actions/workflows/R-CMD-check.yaml" class="external-link"><img src="https://github.com/hypertidy/anglr/actions/workflows/R-CMD-check.yaml/badge.svg" alt="R-CMD-check"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Michael D. Sumner.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
